---
title: Middlewares
icon: ri:shield-user-line
---

# Middlewares

Nitro supports globals middlewares to hook into the request lifecycle.

::alert{type=primary}
Middlewares can only interact before the request is processed.
::

Middlewares are auto-registered within the `middlewares/` directory.

```md
routes/
  hello.ts
middlewares/
  auth.ts
  logger.ts
  ...
nitro.config.ts
```

## Simple middleware

Middleware is defined as a route handler. You can use every composables available in Nitro in your middleware.

```ts [middlewares/auth.ts]
export default defineEventHandler((event) => {
  // Extends or modify the event
  event.context.user = { name: 'Nitro' }
})
```

::alert
Never return anything from a middleware, you will close the request.
::

## Order of execution

Middlewares are executed in the order of the directory listing.

```md
middlewares/
  auth.ts <-- First
  logger.ts <-- Second
  ... <-- Third
```

You can prefix your middleware with a number to control the order of execution.

```md
middlewares/
  1.logger.ts <-- First
  2.auth.ts <-- Second
  3.... <-- Third
```

You can also put your middleware in a subdirectory to group them together.

```md
middlewares/
  auth/
    index.ts
    ...
  logger/
    index.ts
    ...
```

## Select routes

Middlewares are executed for all routes by default. But you can add logic to only execute them for specific routes.

```ts [middlewares/auth.ts]
export default defineEventHandler((event) => {
  if (event.node.req.url?.startsWith('/auth')) {
    // Will only execute for /auth route
    event.context.user = { name: 'Nitro' }
  }
})
```
